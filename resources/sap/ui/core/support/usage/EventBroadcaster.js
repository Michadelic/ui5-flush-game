/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","../../Component","../../Element","../../routing/Router"],function(e,t,n,a){"use strict";var o={},i={modelContextChange:o,beforeRendering:o,afterRendering:o,propertyChanged:o,aggregationChanged:o,componentCreated:o,afterInit:o,updateStarted:o,updateFinished:o,load:o,scroll:o,beforeGeometryChanged:o,geometryChanged:o};var r={};r.enable=function(){n._interceptEvent=function(e,t,n){r.broadcastEvent(e,t,n)};a._interceptRouteMatched=function(e,t){r.broadcastRouteMatched(a.M_EVENTS.ROUTE_MATCHED,e,t)}};r.disable=function(){if(n._interceptEvent){delete n._interceptEvent}if(a._interceptRouteMatched){delete a._interceptRouteMatched}};r.broadcastEvent=function(t,n,a){var o=new Date;setTimeout(function(){var i={},s;if(r._shouldExpose(t,n)){s=r._createOwnerComponentInfo(n);i={componentId:s.id,componentVersion:s.version,eventName:t,targetId:n.getId(),targetType:n.getMetadata().getName(),timestamp:o.getTime()};if(e.isLoggable()){e.debug("EventBroadcaster: Broadcast Event: ",JSON.stringify(i))}i.additionalAttributes=a;r._dispatchCustomEvent(i)}})};r.broadcastRouteMatched=function(t,n,a){var o=new Date;setTimeout(function(){var i=r._createOwnerComponentInfo(sap.ui.getCore().byId(n)),s={componentId:i.id,componentVersion:i.version,eventName:t,targetId:n,targetType:"sap.ui.core.routing.Router",timestamp:o.getTime(),additionalAttributes:{fullURL:document&&document.baseURI,hash:a.getHashChanger().getHash(),previousHash:r._previousHash}};r._previousHash=s.additionalAttributes.hash;if(e.isLoggable()){e.debug("EventBroadcaster: Broadcast Route Matched: ",JSON.stringify(s))}r._dispatchCustomEvent(s)})};r._dispatchCustomEvent=function(e){var t=new window.CustomEvent("UI5Event",{detail:e});window.dispatchEvent(t)};r._shouldExpose=function(e,t){return!i[e]&&r._isPublicElementEvent(e,t)};r._isPublicElementEvent=function(e,t){return t.getMetadata().hasEvent(e)};r._createOwnerComponentInfo=function(e){var n,a,o,i;if(e){while(e&&e.getParent){o=t.getOwnerComponentFor(e);if(o||e.getMetadata().isA("sap.ui.core.Component")){o=o||e;i=o.getManifestEntry("sap.app");n=i&&i.id||o.getMetadata().getName();a=i&&i.applicationVersion&&i.applicationVersion.version}e=e.getParent()}}return{id:n||"undetermined",version:a||""}};function s(){if(typeof window.CustomEvent==="function"){return false}function e(e,t){t=t||{bubbles:false,cancelable:false,detail:undefined};var n=document.createEvent("CustomEvent");n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail);return n}e.prototype=window.Event.prototype;window.CustomEvent=e}s();return r});