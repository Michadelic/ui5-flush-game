/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/ObjectPath"],function(e){"use strict";var r={};r.getPastedDataAs2DArray=function(e){var r=e.clipboardData;if(!r){r=window.clipboardData}var a=/sapui5Placeholder4MultiLine/g;var t=a.source;var n=/""/g;var i,s,o,l=[];if(r){i=r.getData("Text");var p=[];var u=false;var f=i.indexOf('"'),c=-1;var h,g;while(f>-1){g=i.charAt(f-1);if(f===0||g==="\n"||g==="\t"||g==="\r"){c=i.indexOf('"',f+1);if(c>-1){h=i.charAt(c+1);while(c>-1&&h==='"'){c=i.indexOf('"',c+2);h=i.charAt(c+1)}if(h==="\n"||h==="\t"||h===""||h==="\r"){var v=i.substring(f+1,c);i=i.replace('"'+v+'"',t);v=v.replace(n,'"');p.push(v);f=i.indexOf('"',f+t.length+1);u=true}}}if(!u){f=i.indexOf('"',f+1)}u=false}s=i.split(/\r\n|\r|\n/);var y=0;var m=function(){return p[y++]};for(var d=0;d<s.length;d++){o=s[d];if(p.length>0){o=o.replace(a,m)}if(o.length||d<s.length-1){l.push(o.split("\t"))}}}return l};r.parse=function(a,t){var n={parsedData:null,errors:null};if(!a){throw new Error("Parameter aData is not specified")}if(t){for(var i=0;i<t.length;i++){var s=t[i];if(s.ignore){continue}if(s.property){if(s.type){var o=s.type;if(o.isA&&o.isA("sap.ui.model.SimpleType")){s.typeInstance=o}else{o=e.get(s.type);if(o){s.typeInstance=new o}else{throw new Error("Data type "+s.type+" is not available")}}}else if(s.customParseFunction==undefined){throw new Error("Missing ColumnInfo.type or custom type parse function for column "+(i+1)+". Check the application calling PasteHelper.parse(aData, aColumnInfo) and specify the missing type in the parameter aColumnInfo.")}}else{throw new Error("Missing ColumnInfo.property for column "+(i+1)+". Check the application calling PasteHelper.parse(aData, aColumnInfo) and specify the missing property in the parameter aColumnInfo.")}}}else{throw new Error("Missing parameter aColumnInfo")}var l=[],p=[];for(var i=0;i<a.length;i++){var u=a[i];var f=r._parseRow(u,t,i,l);p.push(f)}if(l.length>0){n.parsedData=null;n.errors=l}else{n.parsedData=p;n.errors=null}return Promise.resolve(n)};r._parseRow=function(e,r,a,t){var n=sap.ui.getCore().getLibraryResourceBundle(),i={};for(var s=0;s<r.length&&s<e.length;s++){var o=r[s];if(o.ignore){continue}var l=e[s];try{if(o.typeInstance){l=o.typeInstance.parseValue(l,"string");o.typeInstance.validateValue(l)}else if(o.customParseFunction){l=o.customParseFunction(l)}}catch(e){var p={row:a+1,column:s+1,property:o.property,value:l,type:o.type,message:n.getText("PasteHelper.ErrorMessage",[l,a+1,s+1,o.type])+" "+e.message+"\n"};t.push(p);l=null}i[o.property]=l}return i};return r});