/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["../base/Object","../base/ManagedObject","./ElementMetadata","../Device","sap/ui/performance/trace/Interaction","sap/base/Log","sap/base/assert","sap/ui/thirdparty/jquery"],function(t,e,r,i,n,o,a,s){"use strict";var l=e.extend("sap.ui.core.Element",{metadata:{stereotype:"element",abstract:true,publicMethods:["getId","getMetadata","getTooltip_AsString","getTooltip_Text","getModel","setModel","hasModel","bindElement","unbindElement","getElementBinding","prop","getLayoutData","setLayoutData"],library:"sap.ui.core",aggregations:{tooltip:{name:"tooltip",type:"sap.ui.core.TooltipBase",altTypes:["string"],multiple:false},customData:{name:"customData",type:"sap.ui.core.CustomData",multiple:true,singularName:"customData"},layoutData:{name:"layoutData",type:"sap.ui.core.LayoutData",multiple:false,singularName:"layoutData"},dependents:{name:"dependents",type:"sap.ui.core.Element",multiple:true},dragDropConfig:{name:"dragDropConfig",type:"sap.ui.core.dnd.DragDropBase",multiple:true,singularName:"dragDropConfig"}}},constructor:function(t,r){e.apply(this,arguments)},renderer:null},r);l.defineClass=function(e,i,n){return t.defineClass(e,i,n||r)};l.prototype.getInterface=function(){return this};l.prototype._handleEvent=function(t){var e=this,r="on"+t.type;function i(i){var n,o,a;if(i&&(o=i.length)>0){i=o===1?i:i.slice();for(n=0;n<o;n++){if(t.isImmediateHandlerPropagationStopped()){return}a=i[n].oDelegate;if(a[r]){a[r].call(i[n].vThis===true?e:i[n].vThis||a,t)}}}}i(this.aBeforeDelegates);if(t.isImmediateHandlerPropagationStopped()){return}if(this[r]){this[r](t)}i(this.aDelegates)};l.prototype.init=function(){};l.prototype.exit=function(){};l.create=e.create;l.prototype.toString=function(){return"Element "+this.getMetadata().getName()+"#"+this.sId};l.prototype.getDomRef=function(t){return(t?this.getId()+"-"+t:this.getId())?window.document.getElementById(t?this.getId()+"-"+t:this.getId()):null};l.prototype.$=function(t){return s(this.getDomRef(t))};l.prototype.isActive=function(){return this.oParent&&this.oParent.isActive()};l.prototype.prop=function(t,e){var r=this.getMetadata().getAllSettings()[t];if(r){if(arguments.length==1){return this[r._sGetter]()}else{this[r._sMutator](e);return this}}};l.prototype.insertDependent=function(t,e){return this.insertAggregation("dependents",t,e,true)};l.prototype.addDependent=function(t){return this.addAggregation("dependents",t,true)};l.prototype.removeDependent=function(t){return this.removeAggregation("dependents",t,true)};l.prototype.removeAllDependents=function(){return this.removeAllAggregation("dependents",true)};l.prototype.destroyDependents=function(){return this.destroyAggregation("dependents",true)};l.prototype.rerender=function(){if(this.oParent){this.oParent.rerender()}};l.prototype.getUIArea=function(){return this.oParent?this.oParent.getUIArea():null};l.prototype.destroy=function(t){if(this.bIsDestroyed){return}var r=!this.getParent();var i=t==="KeepDom";l._updateFocusInfo(this);e.prototype.destroy.call(this,t);if(t===true||this.isA("sap.ui.core.PopupInterface")||!i&&r){this.$().remove()}else if(!i){this.$().removeAttr("data-sap-ui-preserve").find('[id^="'+this.getId()+'-"]').andSelf().each(function(){this.id="sap-ui-destroyed-"+this.id})}this.data=u};function u(){var t=arguments.length;if(t===1&&arguments[0]!==null&&typeof arguments[0]=="object"||t>1&&t<4&&arguments[1]!==null){o.error("Cannot create custom data on an already destroyed element '"+this+"'");return this}return l.prototype.data.apply(this,arguments)}l.prototype.fireEvent=function(t,r,i,o){if(this.hasListeners(t)){n.notifyStepStart(this)}if(typeof r==="boolean"){o=i;i=r;r=null}r=r||{};r.id=r.id||this.getId();if(l._interceptEvent){l._interceptEvent(t,this,r)}return e.prototype.fireEvent.call(this,t,r,i,o)};l._interceptEvent=undefined;l.prototype.addDelegate=function(t,e,r,i){a(t,"oDelegate must be not null or undefined");if(!t){return this}this.removeDelegate(t);if(typeof e==="object"){i=r;r=e;e=false}if(typeof r==="boolean"){i=r;r=undefined}(e?this.aBeforeDelegates:this.aDelegates).push({oDelegate:t,bClone:!!i,vThis:r===this?true:r});return this};l.prototype.removeDelegate=function(t){var e;for(e=0;e<this.aDelegates.length;e++){if(this.aDelegates[e].oDelegate==t){this.aDelegates.splice(e,1);e--}}for(e=0;e<this.aBeforeDelegates.length;e++){if(this.aBeforeDelegates[e].oDelegate==t){this.aBeforeDelegates.splice(e,1);e--}}return this};l.prototype.addEventDelegate=function(t,e){return this.addDelegate(t,false,e,true)};l.prototype.removeEventDelegate=function(t){return this.removeDelegate(t)};l.prototype.getFocusDomRef=function(){return this.getDomRef()||null};function p(t){var e,r=[];e=t.parentNode;while(e){r.push({node:e,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop});e=e.parentNode}return r}function g(t){t.forEach(function(t){var e=t.node;if(e.scrollLeft!==t.scrollLeft){e.scrollLeft=t.scrollLeft}if(e.scrollTop!==t.scrollTop){e.scrollTop=t.scrollTop}})}l.prototype.focus=function(t){var e=this.getFocusDomRef(),r;t=t||{};if(e){if(t.preventScroll===true){r=p(e)}e.focus();if(r&&r.length>0){if(i.browser.safari||i.browser.msie||i.browser.edge){setTimeout(g.bind(null,r),0)}else{g(r)}}}};l.prototype.getFocusInfo=function(){return{id:this.getId()}};l.prototype.applyFocusInfo=function(t){this.focus(t);return this};l.prototype._refreshTooltipBaseDelegate=function(t){var e=sap.ui.require("sap/ui/core/TooltipBase");if(e){var r=this.getTooltip();if(r instanceof e){this.removeDelegate(r)}if(t instanceof e){t._currentControl=this;this.addDelegate(t)}}};l.prototype.setTooltip=function(t){this._refreshTooltipBaseDelegate(t);this.setAggregation("tooltip",t);return this};l.prototype.getTooltip=function(){return this.getAggregation("tooltip")};l.runWithPreprocessors=e.runWithPreprocessors;l.prototype.getTooltip_AsString=function(){var t=this.getTooltip();if(typeof t==="string"||t instanceof String){return t}return undefined};l.prototype.getTooltip_Text=function(){var t=this.getTooltip();if(t&&typeof t.getText==="function"){return t.getText()}return t};(function(){var t=function(t,e){var r=t.getAggregation("customData");if(r){for(var i=0;i<r.length;i++){if(r[i].getKey()==e){return r[i]}}}return null};var e=function(e,r,i,n){if(i===null){var o=t(e,r);if(!o){return}var a=e.getAggregation("customData").length;if(a==1){e.destroyAggregation("customData",true)}else{e.removeAggregation("customData",o,true);o.destroy()}}else{var s=sap.ui.requireSync("sap/ui/core/CustomData");var o=t(e,r);if(o){o.setValue(i);o.setWriteToDom(n)}else{var o=new s({key:r,value:i,writeToDom:n});e.addAggregation("customData",o,true)}}};l.prototype.data=function(){var r=arguments.length;if(r==0){var i=this.getAggregation("customData"),n={};if(i){for(var o=0;o<i.length;o++){n[i[o].getKey()]=i[o].getValue()}}return n}else if(r==1){var a=arguments[0];if(a===null){this.destroyAggregation("customData",true);return this}else if(typeof a=="string"){var s=t(this,a);return s?s.getValue():null}else if(typeof a=="object"){for(var l in a){e(this,l,a[l])}return this}else{throw new Error("When data() is called with one argument, this argument must be a string, an object or null, but is "+typeof a+":"+a+" (on UI Element with ID '"+this.getId()+"')")}}else if(r==2){e(this,arguments[0],arguments[1]);return this}else if(r==3){e(this,arguments[0],arguments[1],arguments[2]);return this}else{throw new Error("data() may only be called with 0-3 arguments (on UI Element with ID '"+this.getId()+"')")}}})();l.prototype.clone=function(t,r){var i=e.prototype.clone.apply(this,arguments);for(var n=0;n<this.aDelegates.length;n++){if(this.aDelegates[n].bClone){i.aDelegates.push(this.aDelegates[n])}}for(var n=0;n<this.aBeforeDelegates.length;n++){if(this.aBeforeDelegates[n].bClone){i.aBeforeDelegates.push(this.aBeforeDelegates[n])}}if(this._sapui_declarativeSourceInfo){i._sapui_declarativeSourceInfo=s.extend({},this._sapui_declarativeSourceInfo)}return i};l.prototype.findElements=e.prototype.findAggregatedObjects;function f(t){var e=t.getParent();if(e){var r=s.Event("LayoutDataChange");r.srcControl=t;e._handleEvent(r)}}l.prototype.setLayoutData=function(t){this.setAggregation("layoutData",t,true);f(this);return this};l.prototype.destroyLayoutData=function(){this.destroyAggregation("layoutData",true);f(this);return this};l.prototype.bindElement=e.prototype.bindObject;l.prototype.unbindElement=e.prototype.unbindObject;l.prototype.getElementBinding=e.prototype.getObjectBinding;l.prototype._getFieldGroupIds=function(){var t;if(this.getMetadata().hasProperty("fieldGroupIds")){t=this.getFieldGroupIds()}if(!t||t.length==0){var e=this.getParent();if(e&&e._getFieldGroupIds){return e._getFieldGroupIds()}}return t||[]};l.prototype.getDomRefForSetting=function(t){var e=this.getMetadata().getAllSettings()[t];if(e&&e.selector){var r=this.getDomRef();if(r){r=r.parentNode;if(r&&r.querySelector){var i=e.selector.replace(/\{id\}/g,this.getId().replace(/(:|\.)/g,"\\$1"));return r.querySelector(i)}}}return null};l.prototype._getMediaContainerWidth=function(){if(typeof this._oContextualSettings==="undefined"){return undefined}return this._oContextualSettings.contextualWidth};l.prototype._getCurrentMediaContainerRange=function(t){var e=this._getMediaContainerWidth();t=t||i.media.RANGESETS.SAP_STANDARD;return i.media.getCurrentRange(t,e)};l.prototype._onContextualSettingsChanged=function(){var t=this._getMediaContainerWidth(),e=t!==undefined,r=e^!!this._bUsingContextualWidth,n=this._aContextualWidthListeners||[];if(r){if(e){n.forEach(function(t){i.media.detachHandler(t.callback,t.listener,t.name)})}else{n.forEach(function(t){i.media.attachHandler(t.callback,t.listener,t.name)})}this._bUsingContextualWidth=e}n.forEach(function(t){var e=this._getCurrentMediaContainerRange(t.name);if(e.from!==t.media.from){t.media=e;t.callback.call(t.listener||window,e)}},this)};l.prototype._attachMediaContainerWidthChange=function(t,e,r){r=r||i.media.RANGESETS.SAP_STANDARD;this._aContextualWidthListeners=this._aContextualWidthListeners||[];this._aContextualWidthListeners.push({callback:t,listener:e,name:r,media:this._getCurrentMediaContainerRange(r)});if(!this._bUsingContextualWidth){i.media.attachHandler(t,e,r)}};l.prototype._detachMediaContainerWidthChange=function(t,e,r){var n;r=r||i.media.RANGESETS.SAP_STANDARD;if(!this._aContextualWidthListeners){return}for(var o=0,a=this._aContextualWidthListeners.length;o<a;o++){n=this._aContextualWidthListeners[o];if(n.callback===t&&n.listener===e&&n.name===r){if(!this._bUsingContextualWidth){i.media.detachHandler(t,e,r)}this._aContextualWidthListeners.splice(o,1);break}}};return l});