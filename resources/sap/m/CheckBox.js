/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Label","./library","sap/ui/Device","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/core/EnabledPropagator","sap/ui/core/library","./CheckBoxRenderer","sap/ui/thirdparty/jquery","sap/ui/events/KeyCodes","sap/ui/core/LabelEnablement"],function(e,t,i,a,r,s,o,n,l,p,u){"use strict";var h=o.ValueState;var c=o.TextAlign;var d=o.TextDirection;var g=a.extend("sap.m.CheckBox",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.m",properties:{selected:{type:"boolean",group:"Data",defaultValue:false},partiallySelected:{type:"boolean",group:"Data",defaultValue:false},enabled:{type:"boolean",group:"Behavior",defaultValue:true},name:{type:"string",group:"Misc",defaultValue:null},text:{type:"string",group:"Appearance",defaultValue:null},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:d.Inherit},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:c.Begin},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:""},useEntireWidth:{type:"boolean",group:"Appearance",defaultValue:false},activeHandling:{type:"boolean",group:"Misc",defaultValue:true},editable:{type:"boolean",group:"Behavior",defaultValue:true},valueState:{type:"sap.ui.core.ValueState",group:"Data",defaultValue:h.None},displayOnly:{type:"boolean",group:"Behavior",defaultValue:false},wrapping:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{_label:{type:"sap.m.Label",group:"Behavior",multiple:false,visibility:"hidden"}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{select:{parameters:{selected:{type:"boolean"}}}},designtime:"sap/m/designtime/CheckBox.designtime"}});s.call(g.prototype);g.prototype.init=function(){this.addActiveState(this);r.insertFontFaceStyle();this._handleReferencingLabels()};g.prototype.exit=function(){this._oLabel=null;delete this._iTabIndex};g.prototype.setSelected=function(e){if(e===this.getSelected()){return this}this.$("CbBg").toggleClass("sapMCbMarkChecked",!!e);var t=this.getDomRef("CB");if(t){e?t.setAttribute("checked","checked"):t.removeAttribute("checked")}this.setProperty("selected",e,true);this.$().attr("aria-checked",this._getAriaChecked());return this};g.prototype.setPartiallySelected=function(e){if(e===this.getPartiallySelected()){return this}this.setProperty("partiallySelected",e,true);this.$("CbBg").toggleClass("sapMCbMarkPartiallyChecked",e);this.$().attr("aria-checked",this._getAriaChecked());return this};g.prototype.setText=function(e){var t=this._getLabel(),i=!!e;this.setProperty("text",e,true);t.setText(e);this.$().toggleClass("sapMCbHasLabel",i);return this};g.prototype.setWidth=function(e){this.setProperty("width",e,true);this._setWidth();return this};g.prototype.setUseEntireWidth=function(e){this.setProperty("useEntireWidth",e,true);this._setWidth();return this};g.prototype.setTextDirection=function(e){var t=this._getLabel();this.setProperty("textDirection",e,true);t.setTextDirection(e);return this};g.prototype.setTextAlign=function(e){var t=this._getLabel();this.setProperty("textAlign",e,true);t.setTextAlign(e);return this};g.prototype.setWrapping=function(e){var t=this._getLabel();this.setProperty("wrapping",e,true);t.setWrapping(e);this.$().toggleClass("sapMCbWrapped",e);return this};g.prototype.addActiveState=function(e){if(i.os.blackberry){e.addDelegate({ontouchstart:function(t){l(e.getDomRef()).addClass("sapMActive")},ontouchend:function(t){l(e.getDomRef()).removeClass("sapMActive")}})}};g.prototype.ontouchstart=function(e){e.originalEvent._sapui_handledByControl=true};g.prototype.ontap=function(e){var t;if(this.getEnabled()&&this.getEditable()&&!this.getDisplayOnly()){this.$().focus();t=this._getSelectedState();this.setSelected(t);this.setPartiallySelected(false);this.fireSelect({selected:t});e&&e.setMarked()}};g.prototype.onkeyup=function(e){if(e&&e.which===p.SPACE&&!e.shiftKey){this.ontap(e);e.preventDefault();e.stopPropagation()}};g.prototype.onsapspace=function(e){e.preventDefault()};g.prototype.onsapenter=function(e){this.ontap(e)};g.prototype.setTabIndex=function(e){this._iTabIndex=e;this.$("CbBg").attr("tabindex",e);return this};g.prototype.getTabIndex=function(){if(this.hasOwnProperty("_iTabIndex")){return this._iTabIndex}return this.getEnabled()&&!this.getDisplayOnly()?0:-1};g.prototype._getLabel=function(){if(!this._oLabel){this._oLabel=new e(this.getId()+"-label",{labelFor:this.getId()}).addStyleClass("sapMCbLabel");this.setAggregation("_label",this._oLabel,true)}return this.getAggregation("_label")};g.prototype._setWidth=function(){var e=this._getLabel(),t=this.$(),i=this.getWidth();if(this.getUseEntireWidth()){e.setWidth("");t.outerWidth(i)}else{t.outerWidth("");e.setWidth(i)}};g.prototype._getSelectedState=function(){var e=this.getSelected(),t=this.getPartiallySelected();return e===t||!e&&t};g.prototype._getAriaChecked=function(){var e=this.getSelected();if(this.getPartiallySelected()&&e){return"mixed"}return e};g.prototype._fnLabelTapHandler=function(){this.$().focus()};g.prototype._handleReferencingLabels=function(){var e=u.getReferencingLabels(this),t=this;if(e.length>0){e.forEach(function(e){sap.ui.getCore().byId(e).addEventDelegate({ontap:function(){t._fnLabelTapHandler()}})})}};g.prototype.getAccessibilityInfo=function(){var e=sap.ui.getCore().getLibraryResourceBundle("sap.m");return{role:"checkbox",type:e.getText("ACC_CTR_TYPE_CHECKBOX"),description:(this.getText()||"")+(this.getSelected()?" "+e.getText("ACC_CTR_STATE_CHECKED"):""),focusable:this.getEnabled()&&!this.getDisplayOnly(),enabled:this.getEnabled(),editable:this.getEditable()}};g.prototype.getFormDoNotAdjustWidth=function(){return this.getText()?false:true};return g});