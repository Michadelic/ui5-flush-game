/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/unified/calendar/CalendarDate","sap/ui/unified/calendar/CalendarUtils","sap/ui/core/date/UniversalDate","sap/ui/core/InvisibleText","sap/ui/unified/library"],function(e,t,a,i,r){"use strict";var l=2;var s=2;var d=1;var n=r.CalendarDayType;var o={};o.render=function(e,t){e.write("<div");e.writeControlData(t);e.addClass("sapMSinglePCGrid");e.writeClasses();e.write(">");e.renderControl(t.getAggregation("_columnHeaders"));this.renderBlockersContainer(e,t);e.write("<div");e.addClass("sapMSinglePCGridContent");e.writeClasses();e.write(">");this.renderRowHeaders(e,t);this.renderNowMarker(e,t);this.renderColumns(e,t);e.write("</div>");e.write("</div>")};o.renderBlockersContainer=function(a,i){var r=i._getColumns(),l=i._getBlockersToRender().iMaxlevel,s=i.getStartDate(),d=(l+1)*i._getBlockerRowHeight()+3;a.write("<div");a.addClass("sapMSinglePCBlockersRow");a.writeClasses();a.write(">");a.write("<div");a.addClass("sapMSinglePCBlockersColumns");a.addStyle("height",d+"px");a.writeClasses();a.writeStyles();a.write(">");this.renderDndPlaceholders(a,i,i.getAggregation("_blockersPlaceholders"));for(var n=0;n<r;n++){var o=new e(s.getFullYear(),s.getMonth(),s.getDate()+n),p=i._formatDayAsString(o);a.write("<div");a.writeAttribute("data-sap-day",p);a.addClass("sapMSinglePCBlockersColumn");if(o.isSame(new e)){a.addClass("sapMSinglePCBlockersColumnToday")}if(t._isWeekend(o,i._getCoreLocaleData())){a.addClass("sapMSinglePCBlockersColumnWeekend")}a.writeClasses();a.write(">");a.write("</div>")}this.renderBlockers(a,i);a.write("</div>");a.write("</div>")};o.renderBlockers=function(e,t){var a=this,r=t._getBlockersToRender().oBlockersList;e.write("<div");e.writeAttribute("role","grid");e.writeAttribute("aria-labelledby",i.getStaticId("sap.m","SPC_BLOCKERS"));e.addClass("sapMSinglePCBlockers");e.addClass("sapUiCalendarRowVisFilled");e.writeClasses();e.write(">");r.getIterator().forEach(function(i){a.renderBlockerAppointment(e,t,i)});e.write("</div>")};o.renderBlockerAppointment=function(a,r,l){var s=e.fromLocalJSDate(r.getStartDate()),d=l.getData(),o=e.fromLocalJSDate(d.getStartDate()),p=e.fromLocalJSDate(d.getEndDate()),w=t._daysBetween(o,s),C=t._daysBetween(p,s),g=r._getColumns(),u=r._getBlockerRowHeight(),c=l.level,b=l.width,v=d.getTooltip_AsString(),S=d.getType(),f=d.getColor(),A=d.getTitle(),y=d.getText(),T=d.getIcon(),M=d.getId(),P={role:"gridcell",labelledby:{value:i.getStaticId("sap.ui.unified","APPOINTMENT"),append:true}},m=r.getAriaLabelledBy(),h=w*(100/g),_=(g-C-1)*(100/g),I=sap.ui.getCore().getConfiguration().getRTL(),D;if(m.length>0){P["labelledby"].value=P["labelledby"].value+" "+m.join(" ")}if(A){P["labelledby"].value=P["labelledby"].value+" "+M+"-Title"}P["labelledby"].value=P["labelledby"].value+" "+M+"-Descr";if(y){P["labelledby"].value=P["labelledby"].value+" "+M+"-Text"}if(d.getSelected()){P["labelledby"].value=P["labelledby"].value+" "+i.getStaticId("sap.ui.unified","APPOINTMENT_SELECTED")}if(d.getTentative()){P["labelledby"].value=P["labelledby"].value+" "+i.getStaticId("sap.ui.unified","APPOINTMENT_TENTATIVE")}a.write("<div");a.writeElementData(d);a.writeAttribute("data-sap-level",c);a.writeAttribute("data-sap-width",b);a.writeAttribute("tabindex",0);if(v){a.writeAttributeEscaped("title",v)}a.writeAccessibilityState(d,P);a.addClass("sapMSinglePCAppointmentWrap");a.addClass("sapUiCalendarRowApps");a.addStyle("top",u*c+1+"px");a.addStyle(I?"right":"left",Math.max(h,0)+"%");a.addStyle(I?"left":"right",Math.max(_,0)+"%");a.writeClasses();a.writeStyles();a.write(">");a.write("<div");a.addClass("sapUiCalendarApp");if(d.getSelected()){a.addClass("sapUiCalendarAppSel")}if(d.getTentative()){a.addClass("sapUiCalendarAppTent")}if(T){a.addClass("sapUiCalendarAppWithIcon")}if(!f&&S&&S!=n.None){a.addClass("sapUiCalendarApp"+S)}if(f){if(sap.ui.getCore().getConfiguration().getRTL()){a.addStyle("border-right-color",f)}else{a.addStyle("border-left-color",f)}}a.writeClasses();a.writeStyles();a.write(">");a.write("<div");a.addClass("sapUiCalendarAppCont");if(f){a.addStyle("background-color",d._getCSSColorForBackground(f));a.writeStyles()}a.writeClasses();a.write(">");if(h<0){D=["sapUiCalendarAppArrowIconLeft","sapUiCalendarAppArrowIcon"];a.writeIcon("sap-icon://arrow-left",D,{title:null})}if(T){D=["sapUiCalendarAppIcon"];var k={};k["id"]=M+"-Icon";k["title"]=null;a.writeIcon(T,D,k)}if(A){a.write("<span");a.writeAttribute("id",M+"-Title");a.addClass("sapUiCalendarAppTitle");a.writeClasses();a.write(">");a.writeEscaped(A,true);a.write("</span>")}if(_<0){D=["sapUiCalendarAppArrowIconRight","sapUiCalendarAppArrowIcon"];a.writeIcon("sap-icon://arrow-right",D,{title:null})}a.write('<span id="'+M+'-Descr" class="sapUiInvisibleText">'+r._getAppointmentStartEndInfo(d)+"</span>");a.write("</div>");a.write("</div>");a.write("</div>")};o.renderRowHeaders=function(e,t){var a=t._getVisibleStartHour(),i=t._getVisibleEndHour(),r=new Date,l=t._getHoursFormat(),s=t._getAMPMFormat();e.write("<div");e.addClass("sapMSinglePCRowHeaders");e.writeClasses();e.write(">");for(var d=a;d<=i;d++){r.setHours(d);e.write("<span");e.addClass("sapMSinglePCRowHeader");e.addClass("sapMSinglePCRowHeader"+d);if(t._shouldHideRowHeader(d)){e.addClass("sapMSinglePCRowHeaderHidden")}e.writeClasses();e.write(">");e.write(l.format(r));if(t._hasAMPM()){e.write("<span");e.addClass("sapMSinglePCRowHeaderAMPM");e.writeClasses();e.write(">");e.write(" "+s.format(r));e.write("</span>")}e.write("</span>")}e.write("</div>")};o.renderColumns=function(a,r){var l=r._getColumns(),s=r.getStartDate(),d=r._getAppointmentsToRender();a.write("<div");a.writeAttribute("role","grid");a.writeAttribute("aria-labelledby",i.getStaticId("sap.m","SPC_APPOINTMENTS"));a.addClass("sapMSinglePCColumns");a.writeClasses();a.write(">");for(var n=0;n<l;n++){var o=new e(s.getFullYear(),s.getMonth(),s.getDate()+n),p=r._formatDayAsString(o);a.write("<div");a.writeAttribute("data-sap-day",p);a.addClass("sapMSinglePCColumn");if(o.isSame(new e)){a.addClass("sapMSinglePCColumnToday")}if(t._isWeekend(o,r._getCoreLocaleData())){a.addClass("sapMSinglePCColumnWeekend")}a.writeClasses();a.write(">");this.renderDndPlaceholders(a,r,r._dndPlaceholdersMap[o]);this.renderRows(a,r);this.renderAppointments(a,r,d[p],o);a.write("</div>")}a.write("</div>")};o.renderDndPlaceholders=function(e,t,a){e.write('<div class="sapMSinglePCOverlay">');a.forEach(e.renderControl);e.write("</div>")};o.renderRows=function(e,t){var a=t._getVisibleStartHour(),i=t._getVisibleEndHour();for(var r=a;r<=i;r++){e.write("<div");e.addClass("sapMSinglePCRow");if(!t._isVisibleHour(r)){e.addClass("sapMSinglePCNonWorkingRow")}e.writeAttribute("data-sap-hour",r);e.writeClasses();e.write(">");e.write("</div>")}};o.renderAppointments=function(e,t,a,i){var r=this;if(a){e.write("<div");e.addClass("sapMSinglePCAppointments");e.addClass("sapUiCalendarRowVisFilled");e.writeClasses();e.write(">");a.oAppointmentsList.getIterator().forEach(function(l){var s=a.iMaxLevel,d=l.level,n=l.width,o=l.getData();r.renderAppointment(e,t,s,d,n,o,i)});e.write("</div>")}};o.renderAppointment=function(e,t,r,o,p,w,C){var g=t._getRowHeight(),u=new a(C.getYear(),C.getMonth(),C.getDate(),t._getVisibleStartHour()),c=new a(C.getYear(),C.getMonth(),C.getDate(),t._getVisibleEndHour(),59,59),b=w.getStartDate(),v=w.getEndDate(),S=w.getTooltip_AsString(),f=w.getType(),A=w.getColor(),y=w.getTitle(),T=w.getText(),M=w.getIcon(),P=w.getId(),m={role:"gridcell",labelledby:{value:i.getStaticId("sap.ui.unified","APPOINTMENT"),append:true}},h=t.getAriaLabelledBy(),_=u.getTime()>b.getTime(),I=c.getTime()<v.getTime(),D=_?0:t._calculateTopPosition(b),k=I?0:t._calculateBottomPosition(v),E=100/(r+1);if(h.length>0){m["labelledby"].value=m["labelledby"].value+" "+h.join(" ")}if(y){m["labelledby"].value=m["labelledby"].value+" "+P+"-Title"}m["labelledby"].value=m["labelledby"].value+" "+P+"-Descr";if(T){m["labelledby"].value=m["labelledby"].value+" "+P+"-Text"}if(w.getSelected()){m["labelledby"].value=m["labelledby"].value+" "+i.getStaticId("sap.ui.unified","APPOINTMENT_SELECTED")}if(w.getTentative()){m["labelledby"].value=m["labelledby"].value+" "+i.getStaticId("sap.ui.unified","APPOINTMENT_TENTATIVE")}e.write("<div");e.writeElementData(w);e.writeAttribute("data-sap-level",o);e.writeAttribute("data-sap-width",p);e.writeAttribute("tabindex",0);if(S){e.writeAttributeEscaped("title",S)}e.writeAccessibilityState(w,m);e.addClass("sapMSinglePCAppointmentWrap");e.addClass("sapUiCalendarRowApps");e.addStyle("top",D+"px");e.addStyle("bottom",k+"px");e.addStyle(sap.ui.getCore().getConfiguration().getRTL()?"right":"left",E*o+"%");e.addStyle("width",E*p+"%");e.writeClasses();e.writeStyles();e.write(">");e.write("<div");e.addClass("sapUiCalendarApp");e.addStyle("min-height",(g-(l+s+d))/2+"px");if(w.getSelected()){e.addClass("sapUiCalendarAppSel")}if(w.getTentative()){e.addClass("sapUiCalendarAppTent")}if(M){e.addClass("sapUiCalendarAppWithIcon")}if(!A&&f&&f!=n.None){e.addClass("sapUiCalendarApp"+f)}if(A){if(sap.ui.getCore().getConfiguration().getRTL()){e.addStyle("border-right-color",A)}else{e.addStyle("border-left-color",A)}}e.writeClasses();e.writeStyles();e.write(">");e.write("<div");e.addClass("sapUiCalendarAppCont");if(A){e.addStyle("background-color",w._getCSSColorForBackground(A));e.writeStyles()}e.writeClasses();e.write(">");if(M){var R=["sapUiCalendarAppIcon"];var U={};U["id"]=P+"-Icon";U["title"]=null;e.writeIcon(M,R,U)}if(y){e.write("<span");e.writeAttribute("id",P+"-Title");e.addClass("sapUiCalendarAppTitle");e.writeClasses();e.write(">");e.writeEscaped(y,true);e.write("</span>")}if(T){e.write("<span");e.writeAttribute("id",P+"-Text");e.addClass("sapUiCalendarAppText");e.writeClasses();e.write(">");e.writeEscaped(T,true);e.write("</span>")}e.write('<span id="'+P+'-Descr" class="sapUiInvisibleText">'+t._getAppointmentStartEndInfo(w)+"</span>");e.write("</div>");e.write("</div>");e.write("</div>")};o.renderNowMarker=function(e,t){var a=new Date;e.write("<div");e.writeAttribute("id",t.getId()+"-nowMarker");e.addStyle("top",t._calculateTopPosition(a)+"px");e.addClass("sapMSinglePCNowMarker");if(t._isOutsideVisibleHours(a.getHours())){e.addClass("sapMSinglePCNowMarkerHidden")}e.writeClasses();e.writeStyles();e.write(">");e.write("<span");e.writeAttribute("id",t.getId()+"-nowMarkerText");e.addClass("sapMSinglePCNowMarkerText");e.writeClasses();e.write(">");e.write(t._formatTimeAsString(a));if(t._hasAMPM()){e.write("<span");e.writeAttribute("id",t.getId()+"-nowMarkerAMPM");e.addClass("sapMSinglePCNowMarkerAMPM");e.writeClasses();e.write(">");e.write(t._addAMPM(a));e.write("</span>")}e.write("</span>");e.write("</div>")};return o},true);